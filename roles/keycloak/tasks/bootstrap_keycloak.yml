---
# Bootstrap the keycloak admin account

# - name: "Bootstrap Keycloak environment using start command"
#   ansible.builtin.command: "{{ keycloak_install_dir }}/bin/kc.sh start"
#   register: build_result
#   changed_when: build_result.rc == 0

- name: "Bootstrap Keycloak admin user using bootstrap-admin user command"
  ansible.builtin.shell: 'export P="{{ keycloak_admin_password }}";{{ keycloak_install_dir }}/bin/kc.sh bootstrap-admin user --verbose --username {{ keycloak_admin_username }} --password:env P' # noqa yaml[line-length]
  register: bootstrap_result
  changed_when: bootstrap_result.rc == 0
